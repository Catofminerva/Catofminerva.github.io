<!DOCTYPE html>
<html>
<head>
    <title>Debug Chat</title>
    <style>
        body { background: black; color: white; }
        #chat-log { height: 200px; overflow-y: scroll; border: 1px solid red; }
    </style>
</head>
<body>
    <div id="chat-log"></div>
    <input type="text" id="message-input">
    <button onclick="sendMessage()">SEND</button>

    <script>
        // Connection status
        let connected = false;
        
        // Get username
        let username = prompt("Enter username:") || "Anonymous";
        alert("Your username is: " + username);
        
        // Connect to server
        const ws = new WebSocket('wss://YOUR-GLITCH-URL.glitch.me');
        
        ws.onopen = () => {
            connected = true;
            alert("Connected to server!");
        };
        
        ws.onmessage = (event) => {
            alert("Received message: " + event.data);
            const msg = JSON.parse(event.data);
            
            if (msg.type === 'history') {
                alert("Loading " + msg.data.length + " old messages");
                msg.data.forEach(m => {
                    document.getElementById('chat-log').innerHTML += 
                        m.username + ": " + m.text + "<br>";
                });
            } else {
                document.getElementById('chat-log').innerHTML += 
                    msg.username + ": " + msg.text + "<br>";
            }
        };
        
        ws.onerror = (error) => {
            alert("Connection error: " + error.message);
        };
        
        function sendMessage() {
            if (!connected) {
                alert("Not connected!");
                return;
            }
            
            const input = document.getElementById('message-input');
            const text = input.value.trim();
            
            if (!text) {
                alert("Empty message!");
                return;
            }
            
            const msg = {
                username: username,
                text: text
            };
            
            ws.send(JSON.stringify(msg));
            alert("Message sent: " + JSON.stringify(msg));
            input.value = '';
        }
    </script>
</body>
</html>
